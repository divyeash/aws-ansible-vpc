- hosts: localhost
  connection: local
  gather_facts: false
  tasks:
   - name: Import Var for vpc
     include_vars: vars/vpc_setup


   - name: create project vpc
     ec2_vpc_net:
       name: "{{vpc_name}}"
       cidr_block: "{{vpcCidr}}"
       region: "{{region}}"
       dns_support: yes
       dns_hostnames: yes
       tenancy: default
       state: "{{state}}"
     register: vpcout


   - name: create pub subnet1 in zone 1
     ec2_vpc_subnet:
       vpc_id: "{{vpcout.vpc.id}}"
       region: "{{region}}"
       az: "{{zone1}}"
       state: "{{state}}"
       cidr: "{{PubSub1Cidr}}"
       map_public: yes
       resource_tags:
         Name: myproj-pubsub1
     register: pubsub1_out

   - name: create pub subnet2 in zone 2
     ec2_vpc_subnet:
       vpc_id: "{{vpcout.vpc.id}}"
       region: "{{region}}"
       az: "{{zone2}}"
       state: "{{state}}"
       cidr: "{{PubSub2Cidr}}"
       map_public: yes
       resource_tags:
         Name: myproj-pubsub2
     register: pubsub2_out

   - name: create pub subnet3 in zone 3
     ec2_vpc_subnet:
       vpc_id: "{{vpcout.vpc.id}}"
       region: "{{region}}"
       az: "{{zone3}}"
       state: "{{state}}"
       cidr: "{{PubSub3Cidr}}"
       map_public: yes
       resource_tags:
        Name: myproj-pubsub3
     register: pubsub3_out

   - name: create pri subnet3 in zone 3
     ec2_vpc_subnet:
       vpc_id: "{{vpcout.vpc.id}}"
       region: "{{region}}"
       az: "{{zone3}}"
       state: "{{state}}"
       cidr: "{{PrivSub3Cidr}}"
       map_public: yes
       resource_tags:
        Name: myproj-prisub3
     register: prisub3_out

   - name: create private subnet1 in zone 1
     ec2_vpc_subnet:
         vpc_id: "{{vpcout.vpc.id}}"
         region: "{{region}}"
         az: "{{zone1}}"
         state: "{{state}}"
         cidr: "{{PrivSub1Cidr}}"
         map_public: yes
         resource_tags:
           Name: myproj-prisub1
     register: pri1_out

   - name: create pri subnet2 in zone 2
     ec2_vpc_subnet:
         vpc_id: "{{vpcout.vpc.id}}"
         region: "{{region}}"
         az: "{{zone2}}"
         state: "{{state}}"
         cidr: "{{PrivSub2Cidr}}"
         map_public: yes
         resource_tags:
           Name: myproj-prisub2
     register: prisub2_out








